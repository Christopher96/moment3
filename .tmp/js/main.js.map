{"version":3,"sources":["main.js"],"names":["$","document","ready","addEventListener","onDeviceReady","supports_html5_storage","supports_json","click","removeImage","takePic","hasInStorage","changeImage","getFromStorage","prop","hide","window","e","onBatteryStatus","console","log","device","cordova","navigator","globalization","StatusBar","show","status","html","level","isPlugged","camera","getPicture","imgBlob","date","Date","imageData","timestamp","toDateString","blob","vibrate","popup","quality","correctOrientation","addToStorage","includes","attr","text","removeFromStorage","notification","alert","alertCallback","id","data","storage","getStorage","saveStorage","current","localStorage","JSON","parse","dir","stringify"],"mappings":"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","file":"main.js","sourcesContent":["\n$(document).ready(function(){\n    document.addEventListener(\"deviceready\", onDeviceReady, false);\n\n    if(supports_html5_storage() && supports_json()){\n\n        $(\"#removeImg\").click(removeImage);\n        $(\"#takeImg\").click(takePic);\n\n        if(hasInStorage(\"mainImg\")){\n            changeImage(getFromStorage(\"mainImg\"));\n        }\n    } else {\n        $(\"#takeImg\").prop(\"disabled\", true);\n        $(\"#mainImg\").hide();\n    }\n});\n\nfunction supports_html5_storage() {\n  try {\n    return 'localStorage' in window && window['localStorage'] !== null;\n  } catch (e) {\n    return false;\n  }\n}\nfunction supports_json() {\n  try {\n    return 'JSON' in window && window['JSON'] !== null;\n  } catch (e) {\n    return false;\n  }\n}\n\nfunction onDeviceReady() {\n\n    window.addEventListener(\"batterystatus\", onBatteryStatus, false);\n    console.log(device.cordova);\n    console.log(navigator.globalization);\n    StatusBar.show();\n}\n\nfunction onBatteryStatus(status) {\n    $(\"#battery\").html(\"Level: \" + status.level + \" isPlugged: \" + status.isPlugged);\n}\n\nfunction takePic() {\n    navigator.camera.getPicture(\n    function(imgBlob) {\n        var date = new Date();\n        var imageData = {\n            timestamp: date.toDateString(),\n            blob: imgBlob\n        }\n        changeImage(imageData);\n        navigator.vibrate(1000);\n        popup(\"Din bild har sparats!\");\n    }, function(){\n        popup(\"Det gick inte att ta bilden...\");\n    }, {\n        quality: 100,\n        correctOrientation: true\n    });\n}\n\nfunction changeImage(imageData){\n    var imgBlob = imageData.blob;\n    addToStorage(\"mainImg\", imageData);\n    if(!(imgBlob).includes(\"file:///\")) {\n        imgBlob = \"data:image/jpeg;base64,\" + imgBlob;\n    }\n    $(\"#mainImg\").attr(\"src\", imgBlob);\n    $(\"#mainImg\").show();\n\n    $(\"#timestamp span\").text(imageData.timestamp);\n    $(\"#timestamp\").show();\n\n    $(\"#noImg\").hide();\n\n    $(\"#takeImg\").hide();\n    $(\"#removeImg\").show();\n}\n\nfunction removeImage(){\n    removeFromStorage(\"mainImg\");\n\n    $(\"#mainImg\").hide();\n    $(\"#timestamp\").hide();\n    \n    $(\"#noImg\").show();\n  \n    $(\"#takeImg\").show();\n    $(\"#removeImg\").hide();\n\n    popup(\"Din bild har raderats!\");\n}\n\nfunction popup(text) {\n    navigator.notification.alert(\n        text,  // message\n        alertCallback,         // callback\n        'Bildfunktion',            // title\n        'Ok'                  // buttonName\n    );\n}\n\n//Adding to storage\nfunction addToStorage(id,data){\n    var storage = getStorage();\n    storage[id] = data;\n    saveStorage(storage);\n}\n\n//loading from storage\nfunction getStorage(){\n    var current = localStorage[\"main\"];\n    var storage = {};\n    if(typeof current != \"undefined\") storage=window.JSON.parse(current);\n    return storage;\n}\n\nfunction getFromStorage(id) {\n    var storage = getStorage();\n    return storage[id]\n}\n\n//Checking storage\nfunction hasInStorage(id){\n    return (id in getStorage());\n}\n\n//Adding to storage\nfunction removeFromStorage(id,data){\n    if (hasInStorage(id)) {\n        var storage = getStorage();\n        delete storage[id];\n        console.log('removed '+id);\n        saveStorage(storage);\n    }\n}\n\n//save storage\nfunction saveStorage(storage){\n    console.log(\"To store...\");\n    console.dir(storage);\n    localStorage[\"main\"] = window.JSON.stringify(storage);\n}\n\nfunction alertCallback() {\n    console.log(\"callback\");\n}\n"]}